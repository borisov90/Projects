<html><head>
    <title></title>
<!-- <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.7.1.min.js" type="text/javascript"></script> -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

<!--Latest compiled and minified CSS-->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

<!--Optional theme-->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">


<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.10.0/css/bootstrap-select.min.css">

<!-- Latest compiled and minified JavaScript -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.10.0/js/bootstrap-select.min.js"></script>

<!-- (Optional) Latest compiled and minified JavaScript translation files -->
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.10.0/js/i18n/defaults-*.min.js"></script> -->


<link rel="stylesheet" type="text/css" href="Scripts/jquery_ui_1.9.2.custom.css">

<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
<script src="../ClientGlobalContext.js.aspx" type="text/javascript"></script>
               
<script type="text/javascript" src="Scripts/jquery.js"></script>
<script type="text/javascript" src="Scripts/jquery_ui_1.9.2.custom.js"></script>
<script type="text/javascript" src="Scripts/jqueryResize.js"></script>
<script type="text/javascript" src="Scripts/teethChild.js"></script>
<script type="text/javascript" src="Scripts/RESTJQueryContactEditor.js" ></script>

<script src="../ClientGlobalContext.js.aspx" type="text/javascript"></script>
<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.7.1.min.js" type="text/javascript"></script>
<!--<script src="https://raw.githubusercontent.com/ganeshmax/jcarousellite/master/versions/jquery.jcarousellite-1.0.1.min.js" type="text/javascript"></script>-->
<script src="https://cdn.rawgit.com/ganeshmax/jcarousellite/master/versions/jquery.jcarousellite-1.0.1.min.js" type="text/javascript"></script>
<script>

function SearchCompleted(data, textStatus, XmlHttpRequest) {


    var carouselToCmpare = $("#carousel-ul"); 

    carouselToCmpare.children().remove();

     if (data && data.length > 0) {

                //var select = document.getElementById('selectBox');

                for (var i = 0; i < data.length; i++) {


                        var idString = "" + data[i].AttachmentId.Id.toString();    
                        var nameString = "" + data[i].Body.toString();
                        var mimeType = "" + data[i].MimeType.toString();
                        var fileName = "" + data[i].FileName.toString();

                       // "XrmServices/2011/OrganizationData.svc/ActivityMimeAttachmentSet?$select=Body,MimeType&$filter=AttachmentId eq "


                       /* var option = document.createElement("option");
                        option.text = nameString;
                        select.add(option);*/

                       /* var optionToAdd = new Option(idString, nameString);
                        /// jquerify the DOM object 'o' so we can use the html method
                        $(optionToAdd).html(nameString);
                        $(".selectpicker").append(optionToAdd);*/
                         /*$(".selectpicker").selectpicker('refresh');*/
                        var optionToAdd = [
                        [idString, nameString, mimeType]
                        ];


                        // Add the results to the carousel ul            
                    
                // Build up an img tag surrounded by a li tag to add to the carousel ul                
                var img = "<li><img src='";                                
 
                // set src attribute of default profile picture web resource.                                    
                // here we use DataURI schema which has 32kb limit in IE8 and doesn't support IE <= 7.                                    
                var src = "data:" + mimeType + ";base64," + nameString;                                
 
                img += src;                
                img += "'class='thumbnail'   style='border: 1px solid; margin: 1px; height: 300px; width: 400px; overflow: hidden;' alt='";
                img += fileName + "'></li>";                                
 
                // Add the li with imag inside to the carousel ul                
                carouselToCmpare.append(img);
            
                }

                // Wire-up jCarouselLite to the carousel div            
            $("#carousel").jCarouselLite({
                btnNext: "#next",
                btnPrev: "#prev"
            });
                
               
                //Hide the empty message
               
            }
            //Or display the empty table message if no results
        else {

            
        }
        
      
    }

function loadSelectBox(options)
{
        var select = document.getElementById('selectBox');
        for (var i = 0; i < options.length; i++) {
            var select = document.getElementById('selectBox');
            select.options[select.options.length] = new Option(options[i][1], options[i][0], false, false);
        }
        
}

 $(document).ready(function () {   

    //var context =  window.parent.Xrm.Page.context;
    var context = GetGlobalContext();  //--for 2016 



  var clientUrl = context.getClientUrl();   
    
    // Get the entity id    
    //var entityId = context.getQueryStringParameters().id;   

    var entityId = window.parent.Xrm.Page.data.entity.getId();
    //var currentPatientID = window.parent.Xrm.Page.getAttribute("new_patientLookup").getValue();
    
    
    //var quoteId = window.parent.Xrm.Page.data.entity.getId();
    
    var odataSecondOptionFilter = "ObjectId/Id eq guid'" + entityId + "'";


    var carouselToCmpare = $("#carousel-ul");    
   


       if (entityId != null && entityId != "") {
         retrieveMultiple("ActivityMimeAttachmentSet", odataSecondOptionFilter, SearchCompleted, null);
        }
     else {
        console.log("could not get entity id");    
    }
});</script>



<meta><meta><meta><meta><meta><meta></head>

<body style="border-width: 0px; margin: 0px; padding-left: 0px; padding-top: 0px; word-wrap: break-word; background-color: rgb(246, 248, 250);">

    <table class="container">
        <tbody><tr>
            <td>
                <button id="prev" class="btn btn-primary">Предишна</button>
                <button id="next" class="btn btn-primary">Следваща</button>

            </td>
        </tr>
        <tr>
            <td>
                <div id="carousel">
                    <ul id="carousel-ul">
                    </ul>
                </div>
            </td>
        </tr>
    </tbody></table>








</body></html>